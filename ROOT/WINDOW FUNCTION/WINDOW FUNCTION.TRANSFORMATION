{"job":{"components":{"5743":{"id":5743,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":276,"y":129,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[5782],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_DATA_KPI"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_DATA_KPI"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REGION"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_YR"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_MNTH"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TOTAL_TXNS"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TOTAL_REV"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEMO_DB"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5780":{"id":5780,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1593650416,"x":483,"y":131,"width":32,"height":32,"inputConnectorIDs":[5782],"outputConnectorIDs":[5936],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lead/Lag 0"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REGION"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_YR"},"2":{"slot":2,"type":"STRING","value":"Asc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TXN_MNTH"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lead"},"2":{"slot":2,"type":"STRING","value":"TOTAL_TXNS"},"3":{"slot":3,"type":"INTEGER","value":"1"},"4":{"slot":4,"type":"STRING","value":"NEXT_MONTH_TTXN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Lag"},"2":{"slot":2,"type":"STRING","value":"TOTAL_REV"},"3":{"slot":3,"type":"INTEGER","value":"1"},"4":{"slot":4,"type":"STRING","value":"PREV_MONTH_REV"}}}},"visible":true},"6":{"slot":6,"name":"Ignore Nulls","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5934":{"id":5934,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":647,"y":131,"width":32,"height":32,"inputConnectorIDs":[5936],"outputConnectorIDs":[6041],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(\"NEXT_MONTH_TTXN\" , 0)"},"2":{"slot":2,"type":"STRING","value":"NEXT_MONTH_TTXN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(\"PREV_MONTH_REV\" , 0)"},"2":{"slot":2,"type":"STRING","value":"PREV_MONTH_REV"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"NEXT_MONTH_TTXN\" - \"TOTAL_TXNS\""},"2":{"slot":2,"type":"STRING","value":"MONTHWISE_TXN_DIFF"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"\"TOTAL_REV\" - \"PREV_MONTH_REV\""},"2":{"slot":2,"type":"STRING","value":"MONTHWISE_REV"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"6039":{"id":6039,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1802397,"x":828,"y":132,"width":32,"height":32,"inputConnectorIDs":[6041],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Map Values 0"}}}},"visible":true},"2":{"slot":2,"name":"Value Map","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MONTHWISE_TXN_DIFF"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Less than"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"LOSS IN TXN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"MONTHWISE_TXN_DIFF"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"PROFIT IN TXN"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"MONTHWISE_REV"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Less than"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"LOSS IN REV"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"MONTHWISE_REV"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"},"5":{"slot":5,"type":"STRING","value":"PROFIT IN REV"}}}},"visible":true},"3":{"slot":3,"name":"Other","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NO PROFIT NO LOSS"}}}},"visible":true},"4":{"slot":4,"name":"Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OUTCOME"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"5782":{"id":5782,"sourceID":5743,"targetID":5780},"5936":{"id":5936,"sourceID":5780,"targetID":5934},"6041":{"id":6041,"sourceID":5934,"targetID":6039}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"WINDOW FUNCTION","description":null,"type":"TRANSFORMATION","tag":"bf89b5ea-8664-42b5-b321-67539dd4a750"}}